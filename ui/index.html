<head>
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.20.0/dist/themes/bootstrap-table/bootstrap-table.min.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
  <style type="text/css">
    .popover {
      max-width: 800px;
      z-index: 999;
    }
    .modal-footer button {
      display: block;
    }
</style>
</head>
<body>
  
<div class="container my-5">
  <div class="container">
    <table width="100%">
      <td>
        <H1>xyz2swc</H1>
      </td>
      <td>
        <!-- Button trigger modal -->
        <button style="float: right;" type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
          Usage demo
        </button>

        <!-- Modal -->
        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h1 class="modal-title fs-5" id="exampleModalLabel">Usage demo</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <!-- Youtube movie placeholder -->
                <div style="padding:75% 0 0 0;position:relative;">
                  <iframe src="https://player.vimeo.com/video/853219729?badge=0&amp;autopause=0&amp;player_id=0&amp;app_id=58479" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" style="position:absolute;top:0;left:0;width:100%;height:100%;" title="xyz2swc_demo">
                  </iframe>
                </div>
                <script src="https://player.vimeo.com/api/player.js"></script>
              </div>
              <div class="modal-footer">
                <button style="background-color: black;" type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
              </div>
            </div>
          </div>
        </div>
      </td>
    </table>
  </div>
    <p>
      <div class="container">
        <h2>Upload files</h2>
        <form action="javascript:void(0);">
          <div class="input-group mb-3">
            <input type="file" onchange="fileinput()" class="form-control" id="fileselector" multiple 
            accept=".eswc,.nts,.nrx,.xml,.bur,.p,.anat,.obj,.ply,.vtk,.stl,.zip,.traces,.ndf,.swc,.dat,.hoc,.nml,.mtr,.ims,.nmx,.asc,.mat,.am">
            <button class="btn btn-outline-secondary" onclick="sendConvert()" type="submit" name="convertbutton" value="active">Convert/Standardize</button>
            <button class="btn btn-outline-secondary" onclick="sendCheck()" type="submit" name="checkbutton" value="active" >Check</button>
          </div>
        </form>
      </div>
      <div class="container preview">
        <p>No files selected</p>
      </div>
      <div class="container">
        <h2>List of files</h2>
        <div class="progress">
          <div id="progress-success" class="progress-bar bg-success" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
          <div id="progress-failed" class="progress-bar bg-danger" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
        </div>
        <table class="table">
          <thead>
            <tr>
              <th scope="col">#</th>
              <th scope="col">Filename</th>
              <th scope="col">Filesize</th>
              <th scope="col">Convert/Standardize</th>
              <th scope="col">Check (Click for log)</th>
            </tr>
          </thead>
          <tbody id="filetable">
            <tr>
            </tr>
          </tbody>
          <tbody>
            <tr>
              <td>
                <button onclick="getzipped()" class="btn btn-dark">Zip all SWCs</button>
              </td>
              <td>
                <button onclick="getzipped('/getlogs')" class="btn btn-dark">Zip all logs</button>
              </td>
              <td>
                <button onclick="clearlist()" class="btn btn-dark">Clear</button>
              </td>
            </tr>
          </tbody>
        </table>
    </div>
      
  </p>
  <script src="js/jszip.min.js"></script>
  <script src="js/main.js"></script>

  <!-- Remove the container if you want to extend the Footer to full width. -->
<div class="container my-5">

  <footer class="bg-light text-center">
  <!-- Grid container -->
  <div class="container p-4 pb-0">
    <!-- Section: Form -->
    <section class="">
      <form action="">
        <!--Grid row-->
        <div class="row d-flex justify-content-center">
          <!--Grid column-->
          <div class="col">
            <table width="100%">
              <tr>
              <td>
                <p class="pt-2">
                  SWC specification available at <a href="https://swc-specification.readthedocs.io/en/latest/">Readthedocs SWC specification</a>
                </p>
              </td>
              <td>
                <!-- Button trigger modal -->
                <button style="float: right;" type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#specmodal">
                  Specs overview video
                </button>

                <!-- Modal -->
                <div class="modal fade" id="specmodal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h1 class="modal-title fs-5" id="exampleModalLabel">Specs overview video</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                      </div>
                      <div class="modal-body">
                        <!-- Youtube movie placeholder -->
                        <div style="padding:75% 0 0 0;position:relative;">
                          <iframe src="https://player.vimeo.com/video/853224668?badge=0&amp;autopause=0&amp;player_id=0&amp;app_id=58479" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" style="position:absolute;top:0;left:0;width:100%;height:100%;" title="swc_specification_presentation"></iframe>
                        </div>
                        <script src="https://player.vimeo.com/api/player.js"></script>
                      </div>
                      <div class="modal-footer">
                        <button style="background-color: black;" type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                      </div>
                    </div>
                  </div>
                </div>
              </td>
              </tr>
              <tr>
                <td>
                  The following checks are done, both for checked files as well as for the converted files:
                  <!-- Button trigger modal -->
                </td>
                <td>
                  <button style="float: right;" type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#checkmodal">
                    View list of checks
                  </button>
                
                  <!-- Modal -->
                  <div class="modal fade" id="checkmodal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-lg">
                      <div class="modal-content">
                        <div class="modal-header">
                          <h1 class="modal-title fs-5" id="exampleModalLabel">List of checks</h1>
                          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                          <p>The following checks are done, both for checked files as well as for the converted files:</p>
                          <table width="100%" class="table-striped table">
                            <thead>
                            <tr>
                            <th><strong>Check</strong></th>
                            <th><strong>Action/Correction</strong></th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                            <td>Missing Field</td>
                            <td>If the SWC points matrix does not have seven columns, then return an error. All further checks are omitted.</td>
                            </tr>
                            <tr>
                            <td>Number of Lines</td>
                            <td>- Generate an error if no samples are detected. All further checks are omitted.  - If fewer than 20 lines, generate a warning to check file integrity.</td>
                            </tr>
                            <tr>
                            <td>Number of soma Samples</td>
                            <td>Generate warning if no soma samples detected.</td>
                            </tr>
                            <tr>
                            <td>Invalid Parent</td>
                            <td>If the Parent points to an Index value that does not exist, then make the sample with the invalid Parent a root point, and generate a warning to check file integrity.</td>
                            </tr>
                            <tr>
                            <td>Index/Parent Integer</td>
                            <td>If Index and/or Parent are float-formatted integer (e.g., “1.00”), format them as integers. If they are non-integer values (e.g., “1.34”) or non-numerical entries (e.g, “abc”), generate an error.</td>
                            </tr>
                            <tr>
                            <td>XYZ Double</td>
                            <td>Ensure X, Y, and Z coordinates are float/double values. Any NaN or NA values detected in the ASCII text file are treated as 0.0, and a warning is issued to check file integrity.</td>
                            </tr>
                            <tr>
                            <td>Radius Positive Double</td>
                            <td>- Ensure sample Radius is a double/float value.  - If radius is negative or zero, set to 0.5.  - Set any NaN or NA Radius values to 0.5 and generate a warning to check file integrity.</td>
                            </tr>
                            <tr>
                            <td>Non-Standard Type</td>
                            <td>- If Type is float-formatted integer, format as integer. If it is non-integer value or non-numerical entry, change to Type 6 indicating &#39;unspecified neurite&#39;.  - If Type is 0 or an integer greater than 7, set to Type 6.  - If bifurcation and terminal points have non-standard Types, set them to that of parent.</td>
                            </tr>
                            <tr>
                            <td>Sequential Index</td>
                            <td>If the Index values are not in sequential order (starting from 1), then sort and reset Index and Parent numbering.</td>
                            </tr>
                            <tr>
                            <td>Sorted Order</td>
                            <td>- If parent samples are referred to before being defined, then sort and reset Index and Parent numbering.  - Sort indices to ensure that the first sample in the file is a root point. If no sample point is a root, generate an error.</td>
                            </tr>
                            <tr>
                            <td>Soma Contours</td>
                            <td>Detect soma contour(s), and replace each with a single point.</td>
                            </tr>
                            </tbody>
                            </table>
                            
                        </div>
                        <div class="modal-footer">
                          <button style="background-color: black;" type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </td>
              </tr>
              <tr>
                <td colspan="2">
                  API documentation available at <a href="/xyz2swc/docs">https://neuromorpho.org/xyz2swc/docs/</a>
                </td>
              </tr>
            </table>
            
          </div>
          <!--Grid column-->

        </div>
        <!--Grid row-->
      </form>
    </section>
    <!-- Section: Form -->
  </div>
  <!-- Grid container -->

  <!-- Copyright -->
  <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2);">
    © 2023 Copyright:
    <a class="text-dark" href="https://neuromorpho.org/">NeuroMorpho.Org</a>
  </div>
  <!-- Copyright -->
</footer>
  
</div>
<!-- End of .container -->
</body>